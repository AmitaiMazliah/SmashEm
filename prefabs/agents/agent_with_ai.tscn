[gd_scene load_steps=12 format=3 uid="uid://02lpxvdyrnb6"]

[ext_resource type="PhysicsMaterial" uid="uid://nfder5jo4p27" path="res://agent_physics_material.tres" id="1_6ceal"]
[ext_resource type="Script" path="res://scripts/agents/agent_3d.gd" id="2_vuivn"]
[ext_resource type="Script" path="res://scripts/health_bar.gd" id="4_to63g"]
[ext_resource type="Theme" uid="uid://dx4axq65l727t" path="res://theme.tres" id="5_0d42q"]
[ext_resource type="Texture2D" uid="uid://dhlgpfw72xdwl" path="res://art/Untitled_design-removebg-preview.png" id="6_gpni3"]
[ext_resource type="Script" path="res://scripts/agents/agent_ai.gd" id="7_nt7hw"]
[ext_resource type="Script" path="res://scripts/agents/agent_equipment.gd" id="8_huvhx"]
[ext_resource type="Resource" uid="uid://uc34v13np0qq" path="res://resources/items/ice-staff.tres" id="9_b2k0u"]

[sub_resource type="CylinderShape3D" id="CylinderShape3D_6p1x7"]
height = 10.0
radius = 3.5

[sub_resource type="ViewportTexture" id="ViewportTexture_tk74v"]
viewport_path = NodePath("HealthBar3D/SubViewport")

[sub_resource type="ViewportTexture" id="ViewportTexture_k3ahc"]
viewport_path = NodePath("Visuals/SubViewport")

[node name="AgentWithAI" type="RigidBody3D" groups=["Agents"]]
physics_material_override = ExtResource("1_6ceal")
gravity_scale = 0.0
lock_rotation = true
max_contacts_reported = 10
contact_monitor = true
linear_damp = 1.0
script = ExtResource("2_vuivn")
starting_velocity = 110.0
starting_damage = 25

[node name="CollisionShape3D" type="CollisionShape3D" parent="."]
shape = SubResource("CylinderShape3D_6p1x7")

[node name="HealthBar3D" type="Sprite3D" parent="."]
transform = Transform3D(4, 0, 0, 0, 4, 0, 0, 0, 4, 0, 0, -4.68527)
billboard = 1
texture = SubResource("ViewportTexture_tk74v")

[node name="SubViewport" type="SubViewport" parent="HealthBar3D"]
disable_3d = true
transparent_bg = true
snap_2d_transforms_to_pixel = true
snap_2d_vertices_to_pixel = true
size = Vector2i(120, 15)
size_2d_override = Vector2i(120, 15)
size_2d_override_stretch = true

[node name="HealthBar" type="Control" parent="HealthBar3D/SubViewport" node_paths=PackedStringArray("agent")]
layout_mode = 3
anchors_preset = 0
offset_right = 120.0
offset_bottom = 15.0
script = ExtResource("4_to63g")
agent = NodePath("../../..")

[node name="ProgressBar" type="ProgressBar" parent="HealthBar3D/SubViewport/HealthBar"]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
theme = ExtResource("5_0d42q")
value = 55.0
show_percentage = false

[node name="Visuals" type="Sprite3D" parent="."]
transform = Transform3D(4, 0, 0, 0, 4, 0, 0, 0, 4, 0, 0, 0)
axis = 1
no_depth_test = true
texture = SubResource("ViewportTexture_k3ahc")

[node name="SubViewport" type="SubViewport" parent="Visuals"]
disable_3d = true
transparent_bg = true
snap_2d_transforms_to_pixel = true
snap_2d_vertices_to_pixel = true
size = Vector2i(500, 500)

[node name="Sprite2D" type="Sprite2D" parent="Visuals/SubViewport"]
position = Vector2(250, 250)
scale = Vector2(0.5, 0.5)
texture = ExtResource("6_gpni3")

[node name="HeadPlaceHolder" type="Node2D" parent="Visuals/SubViewport"]
position = Vector2(250, 165)

[node name="RightHandPlaceHolder" type="Node2D" parent="Visuals/SubViewport"]
position = Vector2(326, 319)
rotation = 0.349066

[node name="LeftHandPlaceHolder" type="Node2D" parent="Visuals/SubViewport"]
position = Vector2(181, 316)
rotation = -0.349066

[node name="FeetPlaceHolder" type="Node2D" parent="Visuals/SubViewport"]
position = Vector2(250, 345)

[node name="AgentAI" type="Node" parent="."]
script = ExtResource("7_nt7hw")
min_think_time_in_secs = 0.1
max_think_time_in_secs = 1.0

[node name="AgentEquipment" type="Node" parent="." node_paths=PackedStringArray("_head_place_holder", "_right_hand_place_holder", "_left_hand_place_holder", "_legs_place_holder")]
script = ExtResource("8_huvhx")
current_equipment = {
"RightHand": ExtResource("9_b2k0u")
}
_head_place_holder = NodePath("../Visuals/SubViewport/HeadPlaceHolder")
_right_hand_place_holder = NodePath("../Visuals/SubViewport/RightHandPlaceHolder")
_left_hand_place_holder = NodePath("../Visuals/SubViewport/LeftHandPlaceHolder")
_legs_place_holder = NodePath("../Visuals/SubViewport/FeetPlaceHolder")
